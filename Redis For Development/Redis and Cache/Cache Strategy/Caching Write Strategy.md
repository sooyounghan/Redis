-----
### 쓰기 전략과 캐시의 일관성
-----
1. 캐시는 데이터베이스에 저장되어있는 데이터를 단순히 복사해온 값
   - 따라서, 원본 데이터와 동일한 값을 갖도록 유지하는 것이 필수적
   - 만약, 데이터가 변경될 때 원본 데이터베이스만 업데이트돼 캐시에는 변경된 값이 반영되지 않는다면, 데이터 간 불일치 발생 : 캐시 불일치(Cache Inconsistency)
<div align="center">
<img src="https://github.com/user-attachments/assets/2e44447d-25e8-4578-9e6d-b5a966e80e65">
</div>


   - a라는 값은 데이터베이스에 28로 업데이트되었지만, 레디스에는 아직 3인 데이터가 저장
   - 이럴 경우, 다른 애플리케이션이 a라는 값을 레디스에서 먼저 찾아볼 경우, 잘못된 값을 반환하는 상황 발생 가능

2. 캐시를 이용한 쓰기 전략
   - Write Through
     + 데이터베이스에 업데이트 할 때마다 매번 캐시에도 데이터를 함께 업데이트시키는 방식
     + 캐시는 항상 최신의 데이터를 가지고 있을 수 있음 (장점)
     + 데이터는 매번 2개의 저장소에 저장되어야 하므로 데이터를 쓸 때마다, 시간이 많이 소요될 수 있음 (단점)
<div align="center">
<img src="https://github.com/user-attachments/assets/e9f52dea-1a0b-42e5-8f64-e44a5fb0dcc8">
</div>

   - 캐시는 다시 사용될만한 데이터가 저장되는 것이 좋음
   - 하지만, 이 방식의 경우 다시 사용되지 않을 데이터일 수 있는데, 무조건 캐시에도 저장되므로 일종의 리소스 낭비가 발생할 수 있으므로, 이 방식을 사용할 경우 데이터를 저장할 때 만료 시간을 사용해야함
<div align="center">
<img src="https://github.com/user-attachments/assets/f7ad0ff1-3105-4429-9d47-760d21ae9676">
</div>

   - Cache Invalidation
      + 데이터베이스에 값을 업데이트할 때마다 캐시에서는 데이터를 삭제하는 전략
      + 저장소에서 특정 데이터를 삭제하는 것이 새로운 데이터를 저장하는 것보다 훨씬 리소스를 적게 사용하므로 Write Through 단점을 보완한 방법

   - Write Behind(Write Back)
     + 만약 쓰기가 빈번하게 발생하는 서비스라면 이 방식을 고려
     + 데이터베이스에 대량의 쓰기 작업이 발생하면 이는 많은 디스크 I/O를 유발해, 성능 저하가 발생할 수 있음
     + 따라서, 먼저 데이터를 빠르게 접근할 수 있는 캐시에 업데이트한 뒤, 이후에는 건수나 특정 시간 간격 등에 따라 비동기적으로 데이터베이스에 업데이트 하는 것
<div align="center">
<img src="https://github.com/user-attachments/assets/8a672a29-e027-458f-8d64-df5d76447c0b">
</div>

   - 저장되는 데이터가 실시간으로 정확한 데이터가 아니어도 되는 경우 이 방법이 유용할 수 있음
   - 예를 들어, 유튜브와 같은 스트리밍 사이트의 동영상 좋아요 수는 매번 실시간 집계가 필요하진 않음
     + 누군가가 업데이트를 할 때마다 그 데이터가 바로 관계형 데이터베이스에 업데이트된다면, 이는 심각한 성능 저하를 가져올 수 있음
     + 좋아요를 누른 데이터를 우선 레디스에 저장해둔 다음 5분 간격으로 이를 집계해 데이터베이스에 저장하는 과정을 거치면, 데이터베이스 성능을 향상시켜 애플리케이션 성능도 향상시킬 수 있음
     + 물론, 이 방법에서는 캐시에 문제가 생겨 데이터가 날아갈 경우, 최대 5분 동안의 데이터가 날아갈 수 있다는 위험성이 있음을 감수해야함
