-----
### 해시슬롯 구성이 전파되는 방법
-----
1. 레디스 클러스터에서 가장 중요한 기능 중 하나는 커맨드에서 사용한 키의 해시슬롯이 어디에 있는지 파악해 정확한 해시슬롯 위치를 알려주는 것
2. 클러스터에서 해시슬롯의 구성은 두 가지 방법으로 전파
   - 하트비트 패킷 : 마스터 노드가 PING, PONG 패킷을 보낼 때 항상 자기가 갖고 있는 해시슬롯을 패킷 데이터에 추가
   - 업데이트 메세지 : 하트비트 패킷에는 발신하는 노드의 구성 에포크 값이 포함되어 있으며, 패킷을 보낸 노드의 에포크 값이 오래되었다면, 해당 패킷을 받은 노드는 신규 에포크 구성 정보를 포함한 업데이트 메세지를 노드에 보내 하트비트 패킷을 보낸 노드 해시슬롯 구성 업데이트

3. 클러스터가 시작됐을 때, 우선 모드 노드의 해시슬롯은 NULL로 초기화
   - 위 두 가지 방법을 이용해 특정 해시슬롯을 가지고 있는 노드의 메세지를 받으면, 그 때 자기 자신의 해시슬롯 구성 정보 업데이트

4. 초기 해시슬롯 바인딩 정보
```
0 -> NULL
1 -> NULL
2 -> NULL
...
16383 -> NULL
```
   - 만약 노드 A가 해시슬롯 1과 2를 갖고 있다고 주장하는 패킷을 수신했다고 가정
   - 이 때, 패키의 구성 에포크가 3이었다면, 이 패킷을 수신한 노드의 해시슬롯 테이블은 다음과 같이 변경
```
0 -> NULL
1 -> A[3]
2 -> A[3]
...
16383 -> NULL
```
   - 만약 페일오버가 발생한 뒤, 현재의 구성 에포크인 3보다 더 큰 4라는 구성 에코프를 가진 패킷 수신했다고 가정
   - 해당 패킷에서 노드 B가 해시 슬롯 1, 2를 갖고 있다고 가정하면, 하트비트 패킷을 수신한 노드는 해시슬롯 테이블을 다음과 같이 업데이트
```
0 -> NULL
1 -> B[4]
2 -> B[4]
...
16383 -> NULL
```

5. 해시슬롯 구성의 변경은 페일오버와 리샤딩 중에만 발생
   - 페일오버와 리샤딩하는 작업 모두 에포크가 증가하는 작업이므로 작업 이후 변경 사항을 클러스터 전체에 전파
   - 클러스터의 모든 노드는 가장 큰 구성 에포크 값을 가진 노드에 동의하므로 클러스터 내 모든 노드 값 업데이트 가능
   
