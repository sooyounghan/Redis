-----
### 해시태그
-----
1. 💡 클러스터를 사용할 때는 다중 키 커맨드를 사용할 수 없음
2. 다중 키 커맨드는 MGET과 같이 한 번에 여러 키에 접근해 데이터를 가져오는 커맨드
```redis
WGET user1:name user2:name
```
   - 위의 커맨드를 이용하면 user1:name에 대한 값과 user2:name에 대한 값을 한 번에 가져올 수 있음
   - 하지만, 레디스 클러스터에서는 서로 다른 해시슬롯에 속한 키에 대해 다중 키 커맨드를 사용할 수 없음
<div align="center">
<img src="https://github.com/user-attachments/assets/83342538-88aa-430b-86f3-c5a0a15d1479">
</div>

   - user1:name과 user2:name 키는 서로 다른 해시 슬롯에 저장되어 있고, 각 해시슬롯이 6001, 6003 마스터에 저장된다고 가정
   - 클러스터는 키를 이용해 커맨드를 처리할 마스터로 클라이언트의 연결을 리다이렉션하므로 위와 같이 한 번에 2개 이상의 키에 접근해야 하는 커맨드 처리 불가

3. 이 때, 해시태그라는 기능을 사용하면 문제 해결 가능
   - 클러스터에서 데이터는 앞서 설명한 알고리즘을 이용해 키를 해시하므로, 키는 랜덤으로 해시슬롯에 배정
   - 하지만, 키에 대괄호를 사용하면 전체 키가 아닌 대괄호 사이에 있는 값을 이용해 해시될 수 있는데, 이를 해시태그라고 함
```redis
user:{123}:profile
user:{123}:account
```
   - 위 두 키는 대괄호 사이에 123이라는 동일한 값을 가지고 있음 : 같은 해시슬롯, 즉, 같은 마스터에 저장되는 것을 보장
   - 만약 대괄호 사이 아무런 문자열이 없다면 다른 키들과 동일하게 전체 키 문자열로 해싱
   - 여러 개의 {}문자가 포함된 키의 경우, 가장 처음의 {부터 가장 처음의 }사이의 값들이 해싱
<div align="center">
<img src="https://github.com/user-attachments/assets/bc24ffab-fb6b-491b-89be-5b1a3a872e83">
</div>

   - 첫 번쨰 예제 : 괄호 안에 user1000이라는 값으로 해싱
   - 두 번쨰 예제 : 대괄호 사이 아무런 값이 없으므로 키 전체를 이용해 해싱
   - 세 번째 예제 : 첫 번쨰 {와 첫 번째 }사이 있는 값인 {name이라는 값으로 해싱
   - 네 번째 예제 : 첫 번쨰 { } 쌍에 있는 name으로 해싱
```redis
WGET {user}1:name {user}2:name
```
   - 따라서, 클러스터 구조에서 다중 키 커맨드를 사용하고 싶다면, 해시 태그 기능을 사용하면 됨
   - 하지만, 너무 많은 키가 같은 해시태그를 갖고 있다면, 하나의 해시슬롯에 데이터가 물리는 현상이 발생 가능 : 키의 분배에 대한 모니터링 필요
