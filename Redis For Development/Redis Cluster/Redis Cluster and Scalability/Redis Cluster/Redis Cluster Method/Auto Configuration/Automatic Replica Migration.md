-----
### 자동 복제본 마이그레이션
-----
<div align="center">
<img src="https://github.com/user-attachments/assets/293bcd65-a650-4319-8f8d-b95448c7f0df">
</div>

1. 레디스 클러스터는 총 7개 노드로 구성되어 있으며, 6001 / 6002 마스터 클러스터는 각각 1개의 복제본을, 6003 노드는 2개의 복제본을 가지고 있음
   - 만약, 6001 노드에 장애가 발생하면 6005 노드가 마스터로 승격
   - 이후 6005 마스터는 복제본이 없고, 6002 노드는 1개의 복사본, 6003 노드는 2개의 복제본을 가지고 있음

2. 이 상황에서 레디스 클러스터는 각 마스터에 연결된 복제본 노드의 불균형 파악을 위해 6003에 연결되어 있는 2개의 복제본 중 하나를 6005 복제본이 되도록 이동 : 복제본 마이그레이션(Replica Migration)
   - 복제본 마이그레이션은 모든 마스터가 적어도 1개 이상의 복제본에 의해 복제되는 것을 보장
   - 이를 이용해 클러스터 전체의 안정성 향상시킴

3. 이 때, 아무 복제본이나 마이그레이션이 되는 것은 아님
   - 가장 많은 수의 복제본이 연결된 마스터의 복제본 중 하나가 옮겨지게 됨
   - FAIL 상태가 아닌 복제본 노드 ID가 가장 작은 복제본이 이동될 노드로 선택
```redis
cluster-allow-replica-migration yes
cluster-migration-barrier 1
```
   - 마이그레이션은 cluster-allow-replica-migration 옵션이 yes일 때 동작, 기본값은 yes
   - cluster-migration-barrier는 복제본을 마이그레이션 하기 전 마스터가 가지고 있어야 할 최소 복제본 수
     + 예를 들어, 이 값이 2로 설정되었을 경우, 노드 6003의 복제본은 2개를 초과하지 않으므로 복제본의 마이그레이션은 발생하지 않음
