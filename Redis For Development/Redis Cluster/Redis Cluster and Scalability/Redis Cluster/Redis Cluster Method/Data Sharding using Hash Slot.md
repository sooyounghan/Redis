-----
### 해시 슬롯을 이용한 데이터 샤딩
-----
1. 클러스터 구조에서 모든 데이터는 해시슬롯에 저장
   - 레디스는 총 16,384개의 해시 슬롯을 가지며, 마스터 노드는 해시슬롯을 나눠 갖고 있음
   - 3대의 마스터 노드를 클러스터를 구성했을 때의 해시슬롯 분배
<div align="center">
<img src="https://github.com/user-attachments/assets/b996c15a-1130-4494-92f0-8ace86219b80">
</div>

   - 첫 번쨰 마스터 노드 : 0 ~ 5460 까지의 해시슬롯 포함
   - 두 번쨰 마스터 노드 : 5461 ~ 10922 까지의 해시슬롯 포함
   - 세 번쨰 마스터 노드 : 10923 ~ 16383 까지의 해시슬롯 포함

2. 레디스에 입력되는 모든 키는 하나의 해시슬롯에 매핑되며, 해시함수는 다음과 같음
```
HASH_SLOT = CRC16(key) mod 16384
```
   - 키를 CRC16으로 먼저 한 번 암호화
   - 다음 16384라는 값으로 나눈 나머지를 이용해 해시 슬롯 결정
   - 데이터를 저장할 때 뿐만 아니라, 데이터를 읽어올 때에도 위의 함수를 이용해 커맨드를 처리할 저절한 마스터 노드를 찾아감

3. 키가 해시슬롯에 저장되는 과정
<div align="center">
<img src="https://github.com/user-attachments/assets/e647878d-c6a8-4f73-85aa-ea7e94167141">
</div>

   - ID:0817이라는 키를 가지고 올떄, 알고리즘에 의해 키는 5459라는 해시슬롯에 저장
   - 따라서, 클라이언트는 해시슬롯 5459를 갖고 있는 마스터 1에서 데이터를 가지고 올 수 있도록 함
   - ID:87345라는 키에 데이터를 저장할 때도, 우선 키가 저장될 해시슬롯이 5462라는 것을 먼저 계산
   - 그 다음, 해당 해시슬롯을 갖고 있는 두 번쨰 마스터에 데이터를 저장

4. 해시슬롯은 마스터 노드 내에서 자유롭게 옮겨질 수 있으며, 옮겨지는 중에도 데이터는 정상적 접근 가능
   - 이러한 특성으로 인해 하나의 클러스터 내에서 마스터 노드으 ㅣ추가, 삭제는 굉장히 간ㄷ나히 처리 가능
<div align="center">
<img src="https://github.com/user-attachments/assets/b986d6f1-f308-4df3-abc4-098f6bcc7491">
</div>

   - 마스터가 3개이던 클러스터 노드에 1개의 마스터를 추가하는 과정
     + 신규 레디스 노드를 마스터로 추가한 뒤, 기존 노드가 가지고 있던 해시슬롯의 일부를 신규 마스터로 이동시켜주면 됨
     + 마스터 노드 삭제 또한 간단하게 처리할 수 있으며, 삭제할 노드가 갖고 있는 해시슬롯을 전부 다른 마스터로 이동시킨 다음, 노드를 클러스터에서 제외시키면 됨
  
