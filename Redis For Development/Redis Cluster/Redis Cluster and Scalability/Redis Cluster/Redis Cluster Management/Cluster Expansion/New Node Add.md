-----
### 클러스터 확장 - 신규 노드 추가
-----
1. 운영 중인 클러스터에 새로운 노드 추가
   - 클러스터를 확장 시키기 위해 마스터로서 새로운 노드를 추가하고 싶을 수도 있고, 가용성을 위해 복제본을 추가하고 싶을 수 있음
   - 두 경우 모두 추가하고자 하는 레디스가 데이터에 저장되지 않은 상태여야 함
   - 비어 있지 않은 노드를 추가하고자 할 때 다음과 같은 에러 반환
<div align="center">
<img src="https://github.com/user-attachments/assets/daa68239-b2c8-4fbb-8d44-06daf174b731">
</div>

2. 또한 추가하고자 하는 노드는 마찬가지로 설정 파일에 cluster-enabled yes를 추가해 클러스터 노드로 실행된 상태여야 함
3. 앞선 에제에서 ```192.168.0.11 ~ 192.168.0.66```까지의 서버에 클러스터가 구성되어 있었고, ```192.168.0.77``` 서버에 띄워진 레디스를 기존 클러스터에 추가

-----
### 마스터로 추가하기
-----
1. --cluster add-node 커맨드를 사용하면 클러스터에 신규 마스터 노드 추가 가능
   - 첫 번째 인수 : 새로 추가하고자 하는 레디스 노드
   - 두 번쨰 인수 : 기존 클러스터에 속한 노드 중 1개의 노드 지정
```redis
redis-cli --cluster add-node <추가할 노드 IP:PORT> <기존 노드 IP:PORT>
```
<div align="center">
<img src="https://github.com/user-attachments/assets/60468227-ff70-48ac-9391-af6c57d232ea">
</div>

2. 새로운 노드를 추가하기 전 기존 노드의 사앹를 확인한 뒤, 새로운 노드를 추가하는 것 확인할 수 있음
3. 추가한 노드가 잘 구성됐는지 CLUSTER NODES 커맨드를 이용해 확인
<div align="center">
<img src="https://github.com/user-attachments/assets/874d92db-aee5-4c4d-9345-36f846924d8c">
</div>

4. ```192.168.0.77``` 노드가 마스터 노드로서 클러스터에 추가된 것을 확인할 수 있음
5. 하지만 이 상태의 노드는 할당된 해시슬롯이 없으므로 데이터를 보유할 수 없으며, 데이터를 저장하려면 리샤딩 기능을 사용해 직접 해시슬롯을 할당하는 과정을 거쳐야 함

-----
### 복제본으로 추가하기
-----
1. 신규 노드를 복제본으로 추가하는 방법은 마스터를 추가하는 방법과 동일하며, --cluster-slave 옵션을 추가
```redis
redis-cli --cluster add-node <추가할 노드 IP:PORT> <기존 노드 IP:PORT> --cluster-slave [--cluster-master-id <기존 마스터 ID>]
```
2. --cluster-master-id 옵션을 이용해 복제본의 마스터가 될 노드를 지정해지면 신규로 추가하는 노드는 지정한 마스터에 복제본으로 연결
3. 만약 해당 옵션 없이 --cluster-slave 옵션을 이용해 노드를 추가할 때는 추가되는 노드가 임의의 마스터의 복제본으로 연결
4. 만약 클러스터가 대칭적인 구조가 아닐 때에는 복제본이 적게 연결된 마스터를 파악해 그 중 한 마스터의 복제본이 되도록 지정해 균형을 맞추게 됨

5. 기존 클러스터 구성에서 ```192.168.0.55``` IP 복제본이 종료되어 ```192.168.0.11``` IP의 마스터 노드는 아무런 복제본이 없는 상태를 나타냄
<div align="center">
<img src="https://github.com/user-attachments/assets/a12153d8-8488-4fd6-ade3-40b8c90f74a9">
</div>

   - 이런 구성에서 ```192.168.0.77``` IP 노드를 신규 추가하게 되면, 신규로 추가하는 노드는 복제본이 없는 ```192.168.0.11``` IP 마스터 노드의 복제본이 되도록 구성
<div align="center">
<img src="https://github.com/user-attachments/assets/4b0941fc-4509-439d-8e1e-0915c099d726">
</div>

   - Automatically selected master ```192.168.0.11:6379``` : 마스터가 될 노드를 자동으로 ```192.0168.0.11``` IP 노드로 선택했음을 알 수 있음
