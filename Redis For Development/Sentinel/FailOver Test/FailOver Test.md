-----
### 페일오버 테스트
-----
1. 마스터와 복제본이 감시할 수 있도록 센티널이 정상적으로 구성된 것을 확인했다면, 실제 레디스를 운영 서비스에 투입하기 전 페일오버 테스트를 진행하는 것이 좋음
2. 운영 상황에서 마스터 프로세스에 이슈가 생겼을 때, 정상적으로 페일 오버가 동작할 수 있는지 확인하는 것이 좋음
3. 두 가지 방법을 이용해 페일오버 발생 가능
   - 커맨드를 이용한 페일오버 발생 (수동적 페일 오버)
```redis
SENTINEL FAILOVER <master name>
```
   - 센티널에 직접 접속한 뒤 이 커맨드를 사용하면 다른 센티널의 동의를 구하지 않고도 페일오버 바로 발생시킬 수 있음
   - 실제 마스터 상태가 정상적이었을 떄도, 이 커맨드를 사용하면 마스터와 복제본 간 롤 체인지가 발생
   - 센티널과 복제본 노드 간 네트워크 단절 등 이슈로 인해 페일오버가 실패하진 않는지, 센티널에 연결된 애플리케이션의 커넥션이 정상적으로 롤 체인지 된 마스터에 연결되는지 등 정보 확인 가능

   - 마스터 동작을 중지시켜 페일오버 발생 (자동 페일오버)
     + 직접 마스터 노드에 장애를 발생시킨 뒤 페일오버가 잘 발생하는지 확인함으로써 마스터의 상태가 정상이 아닐 경우, 센티널에서 이를 인지할 수 있는지 확인 가능
     + 레디스의 프로세스를 직접 셧다운(Shutdown)
```redis
$ redis-cli -h <master-host> -p <master-port> shutdown
```
   - 센티널은 주기적으로 마스터 노드에 PING을 보내 응답이 정상적으로 돌아오는지 확인함으로 마스터 인스턴스 상태 파악
   - 이 때, sentinel.conf에 지정한 down-after-milliseconds 시간 동안 마스터에서 응답이 오지 않으면 마스터 상태가 정상적이지 않다고 판단해 페일오버를 트리거
   - 해당 옵션의 기본 값은 30,000 ms, 즉 30초이므로 센티널은 30초 동안 마스터에서 응답을 받지 못할 때 마스터 상태가 비정상이라 판단해 페일오버 진행
   - 따라서, 레디스의 마스터 프로세스를 다운 시킨 뒤 30초가 지난 뒤 페일오버가 발생했는지 확인함으로 센티널이 정상적으로 동작하는지 확인 가능

