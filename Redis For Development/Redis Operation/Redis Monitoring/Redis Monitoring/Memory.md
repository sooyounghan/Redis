-----
### 메모리
-----
1. 레디스의 핵심 요소 중 하나이며, 안정적 운영을 위해 주의 깊게 모니터링 해야 하는 지표
2. 레디스 메모리 사용에 대한 핵심 지표 중 하나는 used_memory로, 이는 레디스가 현재 할당한 메모리를 나타냄
   - 또한, 메모리 사용량 상태를 파악하기 위해 현재 메모리 사용량 ByteUsedForCache와 maxmemory의 백분율을 계산하는 DatabaseMemoryUsagePercentage 같은 메트릭 활용 가능

3. DatabaseMemoryUsagePercentage가 100%에 도달하면, 레디스의 maxmemory 정책이 작동하며, 설정된 정책에 따라 이빅션 작업이 발생할 수 있음
   - 이빅션이 모든 상황에서 문제를 일으키는 것은 아니며, 레디스를 캐시로 사용하는 경우에는 데이터 관리를 위해 의도적으로 사용될 수 있음
   - 그러나 데이터 삭제를 원치 않는 경우 이빅션으로 인해 불필요한 데이터가 삭제될 수 있으므로, 이빅션 발생 및 양을 모니터링하는 것이 좋음
   - 또한, 과도한 이빅션 발생은 CPU 사용량 증가로 이어질 수 있으므로 주의 필요

4. 데이터셋의 크기와 TTL(생존 시간)을 고려해 메모리 사용량을 관리하고, 메모리 사용량이 급증하는 경우를 미리 감지할 수 있는 알람을 설정하는 것이 좋음
   - 이를 통해 메모리 관련 문제를 빠르게 식별하고 대응 가능

5. used_memory가 레디스가 논리적으로 사용하는 메모리라면, used_memory_rss는 운영체제가 레디스 프로세스에 할당한 실제 물리적 메모리 양을 반영
   - 논리적인 메모리에 비해 물리적으로 사용하는 메모리가 너무 커질 때 메모리 단편화(Fragmentation) 문제가 발생할 수 있음
   - 메모리 단편화는 레디스에서 사용하지 않는 메모리 조각들이 흩어져 있을 때 발생하며, 이로 인해 메모리 효율성이 떨어질 수 있음
   - 예를 들어, 특정 시점에 키가 갑작스럽게 몰렸다가 갑자기 삭제되는 경우, 또는 만료 시간으로 인해 한꺼번에 이빅션이 많이 발생하는 경우 이런 현상이 자주 발생

7. 레디스에서 메모리 단편화를 관리하기 위해 active defragmentation 기능을 활성화할 수 있음
   - 이 기능은 레디스 4.0 이상에서 사용할 수 있으며, 메모리 단편화 문제를 해결하는데 도움이 됨
   - 기본적으로 비활성화 되어있고, 단편화가 심하게 발생한 경우 기능을 활성화시킬 수 있지만, 단편화 문제가 없다면 활성화 할 필요는 없음
```redis
CONFIG SET activedefrag yes
```
