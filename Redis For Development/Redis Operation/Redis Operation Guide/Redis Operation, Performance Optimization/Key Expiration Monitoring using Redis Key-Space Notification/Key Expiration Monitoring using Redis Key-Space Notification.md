-----
### 레디스 키스페이스 알림 기능을 사용한 키 만료 모니터링
-----
1. 레디스에서 키스페이스 알림(Key-Space Notification) 기능은 레디스 내부 키에 대한 변경 사항을 모니터링하며 내부의 pub / sub 채널을 이용해 변경 사항에 대한 메세지를 구독할 수 있는 기능
   - 예를 들어, 키의 만료를 지속적으로 감시하다가 만료 이벤트가 발생하면 신속하게 감지해 애플리케이션에 필요한 추가 작업 수행 가능
   - 키스페이스 알림을 활성화하기 위해서는 notify-keyspace-events 설정 파일에 어떤 알람을 수신할 것인지 지정해야 함
   - 다음 여러 문자를 조합해 구독하고자 하는 데이터 지정 가능
     + K : 키스페이스 이벤트(Keyspace Events), 이벤트가 발생한 데이터베이스에 대해 ```keyspace@<db>``` 접두사와 함께 발행
     + E : 키 이벤트(Keyevent Events), 이벤트가 발생한 데이터베이스에 대해 ```keyevent@<db>``` 접두사와 함께 발행
     + g : 일반적인 명령 이벤트(Generic Commands), DEL / EXPIRE / RENAME 등과 같은 명령어와 관련된 이벤트
     + $ : 문자열 명령어(String Commands)와 관련된 이벤트
     + l : 리스트 명령어(List Commands)와 관련된 이벤트
     + s : 집합 명령어(Set Commands)와 관련된 이벤트
     + h : Hash 명령어(Hash Commands)와 관련된 이벤트
     + z : 정렬 집합(Sorted set Commands)와 관련된 이벤트
     + t : Stream 명령어(Stream Commands)와 관련된 이벤트
     + x : 만료된 키 이벤트(Expired Events)
     + e : 삭제된 키 이벤트(Evicted Events)
     + m : 누락된 키 이벤트(Key Miss Events), 존재하지 않는 키에 접근할 때 발생
     + n : 새로운 키 이벤트(New Key Events)
     + A : "g$lshztxed"의 별칭으로, m과 n 이벤트를 제외한 모든 이벤트 포함

   - E는 키 이벤트, x는 만료된 상황을 모니터링하겠다는 것을 의미하므로, 만료 이벤트를 수신하기 전에 다음과 같이 CONFIG SET 커맨드 이용 가능
```redis
> CONFIG SET notify-keyspace-events Ex
OK
```
   - __keyevent@0__:expired 채널을 구독하면 키가 만료될 때 아래와 같은 메세지 수신
<div align="center">
<img src="https://github.com/user-attachments/assets/b9c0a5c5-05ec-42a5-9475-96764eac2faf">
</div>

3. 많은 키가 동시에 만료되는 상황이 발생하는 경우 가정
   - 각 키가 만료될 때마다 만료 이벤트가 발생하므로, 동시에 수많은 이벤트 메세지가 발생할 수 있음
   - 이러한 경우 메세지가 너무 많아서 pub / sub 버퍼 크기를 초과한다면 새로운 이벤트 메세지가 버퍼에 저장되지 못하고 유실될 수 있음
   - pub / sub 동작방식 대로, Fire-and-Forget 방식으로 작동하므로 레디스에서 한 번 발행된 이벤트를 재확인 불가
     + 클라이언트의 연결이 해제되면 연결이 끊어졌던 동안 전달된 모든 이벤트를 놓칠 수 있고, 마찬가지로 버퍼에 들어가지 못해 유실된 만료 메세지는 다시 확인할 수 없으므로 이벤트 누락이 발생할 수 있음

   - 따라서, 레디스의 키 만료를 기다리고, 이를 감지해 다른 작업을 수행해야 하는 서비스에서는 메세지를 안정적으로 관리하기 위한 추가적 조치가 필요
     + 특히 많은 키가 동시에 만료될 가능성이 있는 서비스에서는 pub / sub 버퍼의 크기를 늘려 더 많은 이벤트 메세지를 대기시키는 것이 도움이 될 수 있음
     + 그러나 이 때에도, 메모리 사용량을 고려해 버퍼 크기를 조절해야 함
     + 여러 개의 레디스 인스턴스를 사용해 pub / sub 이벤트를 분산 처리하는 것을 고려할 수 있음
